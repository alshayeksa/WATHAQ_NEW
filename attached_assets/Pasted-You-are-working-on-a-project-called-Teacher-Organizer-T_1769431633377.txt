You are working on a project called "Teacher Organizer".

This project uses a PostgreSQL database (Supabase-style) with the following tables and relationships.
Your task is to fully understand the database schema before writing any code.

DATABASE TABLES:

1) profiles
- Stores user profile data.
- Linked 1:1 with auth.users.
Fields:
- id (UUID, PK, references auth.users.id)
- full_name (text)
- email (text, unique)
- avatar_url (text)
- created_at (timestamp)
- updated_at (timestamp)

2) drive_connections
- Stores cloud storage connections (currently Google Drive).
- Each user can have one connection per provider.
Fields:
- id (UUID, PK)
- user_id (UUID, FK → auth.users)
- provider (text: 'google', 'onedrive')
- provider_user_id (text, Google sub)
- refresh_token_encrypted (text)
- scopes (jsonb)
- last_synced_at (timestamp)
- created_at, updated_at
Constraints:
- UNIQUE(user_id, provider)
- UNIQUE(provider, provider_user_id)

3) projects
- Represents a main teacher portfolio (e.g. "Teaching Portfolio 2026").
Fields:
- id (UUID, PK)
- user_id (UUID, FK → auth.users)
- title (text)
- root_drive_id (text, Google Drive folder ID)
- status ('active', 'archived')
- created_at, updated_at

4) folders
- Represents the hierarchical folder structure inside a project.
Fields:
- id (UUID, PK)
- project_id (UUID, FK → projects)
- parent_id (UUID, self reference, nullable)
- drive_folder_id (text, unique)
- folder_name (text)
- sort_order (int)
- created_at, updated_at
Rules:
- A folder belongs to one project
- Folders can be nested
- Folder names are unique per project + parent

5) files_metadata
- Caches Google Drive file metadata for fast access.
Fields:
- id (UUID, PK)
- project_id (UUID, FK → projects)
- folder_id (UUID, FK → folders)
- drive_file_id (text, unique)
- file_name (text)
- mime_type (text)
- size_bytes (bigint)
- checksum (text)
- web_view_link (text)
- is_deleted (boolean)
- deleted_at (timestamp)
- created_at, updated_at

6) share_links
- Controls public / protected sharing and QR access.
Fields:
- id (UUID, PK)
- project_id (UUID, FK → projects)
- slug (text, unique, used in URL)
- access_type ('public', 'pin', 'google_only')
- pin_hash (text, nullable)
- is_enabled (boolean)
- expires_at (timestamp)
- created_at, updated_at

7) audit_logs
- Stores activity logs for auditing.
Fields:
- id (bigint, PK)
- user_id (UUID, FK → auth.users, nullable)
- project_id (UUID, FK → projects, nullable)
- action (text, e.g. FILE_UPLOAD)
- payload (jsonb)
- ip (inet)
- user_agent (text)
- created_at (timestamp)

RELATIONSHIPS SUMMARY:
- One user → many projects
- One project → many folders
- One folder → many files
- One project → many share links
- Deleting a user cascades to projects, folders, files, and share links
- audit_logs are preserved even if user or project is deleted

IMPORTANT RULES:
- Google Drive is the source of truth for files.
- Database is used for structure, metadata, permissions, and fast loading.
- Never store access tokens in plain text.
- Always respect project ownership (user_id).

Confirm understanding of this schema before generating any backend or frontend code.
